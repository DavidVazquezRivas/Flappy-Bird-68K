000018AC Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 18/12/2023 13:50:52

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE       :
00000000                             3  ; DESCRIPTION :
00000000                             4  ; AUTHOR      :
00000000                             5  ; HISTORY     :
00000000                             6  ; =============================================================================
00000000                             7  
00001000                             8              ORG     $1000
00001000                             9              
00001000                            10              ; CONSTANTS INCLUDES
00001000                            11              INCLUDE "SYSCONST.X68"
00001000                            12  ; =============================================================================
00001000                            13  ; SYSTEM CONSTANTS
00001000                            14  ; =============================================================================
00001000                            15  
00001000                            16  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            17  
00001000  =0000003C                 18  SCRFPS      EQU     60                  ; SCREEN FRAMES PER SECOND
00001000  =00000280                 19  SCRWIDTH    EQU     640                 ; SCREEN WIDTH
00001000  =000001E0                 20  SCRHEIGH    EQU     480                 ; SCREEN HEIGHT
00001000                            21  
00001000                            22  ; --- KEYCODES ----------------------------------------------------------------
00001000                            23  
00001000  =00000020                 24  KBDSPACE    EQU     ' '
00001000  =00000050                 25  KBDP        EQU     'P'
00001000                            26  
00001000                            27  ; --- SOUND IDENTIFIERS -------------------------------------------------------
00001000                            28  
00001000  =00000000                 29  SNDDIE      EQU     0
00001000  =00000001                 30  SNDJUMP     EQU     1
00001000  =00000002                 31  SNDSCO      EQU     2
00001000                            32  
00001000                            33  ; --- TRAP NUMBERS ------------------------------------------------------------
00001000                            34  
00001000  =00000000                 35  SCRUPDTN    EQU     0                   ; SCREEN UPDATE TRAP NUMBER
00001000  =00000001                 36  KBDUPDTN    EQU     1                   ; KEYBOARD UPDATE TRAP NUMBER
00001000  =00000002                 37  SNDPLTN     EQU     2                   ; SOUND PLAY TRAP NUMBER
00001000                            38  
00001000                            39  ; --- INTERRUPTION NUMBERS ----------------------------------------------------
00001000                            40  
00001000  =00000001                 41  SCRINTN     EQU     1                   ; SCREEN INTERRUPT TRAP NUMBER    
00001000                            42  
00001000                            43  
00001000                            44  
00001000                            45  
00001000                            46  
00001000                            47  
00001000                            48  
00001000                            49  
00001000                            50  
00001000                            51  -------------------- end include --------------------
00001000                            52              INCLUDE "CONST.X68"
00001000                            53  ; =============================================================================
00001000                            54  ; GAME CONSTANTS
00001000                            55  ; =============================================================================
00001000                            56  
00001000                            57  ; --- BIRD RELATED CONSTANTS --------------------------------------------------
00001000                            58  
00001000  =FFFFFFF6                 59  JUMPVELY    EQU     -10
00001000  =000000A0                 60  BIRDPOSX    EQU     SCRWIDTH/4
00001000  =0000000F                 61  BIRDRAD     EQU     15                  ; BIRD RADIUS
00001000                            62  
00001000                            63  ; --- PIPE RELATED CONSTANTS --------------------------------------------------
00001000                            64  
00001000  =00151A30                 65  PIPEPCOL    EQU     $00151A30           ; PIPE PEN COLOR
00001000  =0020284D                 66  PIPEFCOL    EQU     $0020284D           ; PIPE FILL COLOR
00001000  =FFFFFFFB                 67  PIPEVELX    EQU     -5                  ; PIPE X SPEED
00001000  =00000032                 68  PIPEWIDT    EQU     50                  ; PIPE WIDTH
00001000  =00000078                 69  PIPEGAPS    EQU     120                 ; PIPE GAP SIZE
00001000  =00000001                 70  PIPEAGTP    EQU     1                   ; PIPE AGENT TYPE CODE
00001000  =0000003F                 71  MASKNWPP    EQU     %00111111           ; NEW PIPE MASK 
00001000                            72  
00001000                            73  ; --- BACKGROUND RELATED CONSTANTS --------------------------------------------
00001000                            74  
00001000  =00FFBF80                 75  SKYCOLOR    EQU     $00FFBF80           ; SKY BACKGROUND COLOR
00001000  =0035DE3B                 76  FLOCOLOR    EQU     $0035DE3B           ; FLOOR BACKGROUND COLOR
00001000  =0000003C                 77  FLOHEIGH    EQU     60                  ; FLOOR HEIGHT
00001000                            78  
00001000                            79  ; --- SCOREBOARD RELATED CONSTANTS --------------------------------------------
00001000                            80  
00001000  =0035DE3B                 81  SCOFCOL     EQU     FLOCOLOR           ; TEXT BACKGROUND COLOR
00001000  =0000101D                 82  SCOLINE     EQU     $101D              ; SCORE TEXT COORDINATE 
00001000  =0000101E                 83  HSCOLINE    EQU     $101E              ; HIGHSCORE TEXT COORDINATE
00001000                            84  
00001000                            85  ; --- STATE RELATED CONSTANTS -------------------------------------------------
00001000                            86  
00001000  =FFFFFFFF                 87  STANONE     EQU     -1                 ; NON-EXISTENT STATE NUMBER
00001000  =00000000                 88  STAINTRO    EQU     0                  ; INTRO SCREEN STATE NUMBER
00001000  =00000001                 89  STAINSTR    EQU     1                  ; INSTRUCTION STATE NUMBER
00001000  =00000002                 90  STAGAME     EQU     2                  ; GAME SCREEN STATE NUMBER
00001000  =00000003                 91  STAPAUSE    EQU     3                  ; PAUSE SCREEN STATE NUMBER
00001000  =00000004                 92  STAGOVER    EQU     4                  ; GAME OVER SCREEN STATE NUMBER
00001000                            93  
00001000                            94  ; --- COLORS CONSTANTS 00BBGGRR -----------------------------------------------
00001000                            95  
00001000  =0000BBBB                 96  DKYELLOW    EQU     $0000BBBB           ; DARK YELLOW COLOR
00001000  =0000FFFF                 97  LGYELLOW    EQU     $0000FFFF           ; LIGHT YELLOW COLOR
00001000  =000000BB                 98  DARKRED     EQU     $000000BB           ; DARK RED COLOR
00001000  =000000FF                 99  LIGHTRED    EQU     $000000FF           ; LIGHT RED COLOR
00001000                           100  
00001000                           101  
00001000                           102  
00001000                           103  
00001000                           104  
00001000                           105  
00001000                           106  
00001000                           107  
00001000                           108  
00001000                           109  
00001000                           110  
00001000                           111  
00001000                           112  
00001000                           113  
00001000                           114  
00001000                           115  -------------------- end include --------------------
00001000                           116              ; LIB INCLUDES
00001000                           117              INCLUDE "LIB/DMMCONST.X68"
00001000                           118  ; =============================================================================
00001000                           119  ; DYNAMIC MEMORY MANAGEMENT CONSTANTS (SYSTEM CONSTANTS)
00001000                           120  ; =============================================================================
00001000                           121  
00001000  =00000040                122  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                123  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                124  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000  =00000000                125  -------------------- end include --------------------
00001000                           126              INCLUDE "LIB/UTLCONST.X68"
00001000                           127  ; ==============================================================================
00001000                           128  ; UTIL CONSTANTS
00001000                           129  ; ==============================================================================
00001000                           130  
00001000  =00000008                131  UTLCHRWD    EQU     8                       ; CHARACTER WIDTH IN PIXELS
00001000  =00000008                132  -------------------- end include --------------------
00001000                           133              INCLUDE "LIB/DMMCODE.X68"
00001000                           134  ; =============================================================================
00001000                           135  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
00001000                           136  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
00001000                           137  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
00001000                           138  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
00001000                           139  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
00001000                           140  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
00001000                           141  ; =============================================================================
00001000                           142  
00001000                           143  ; -----------------------------------------------------------------------------
00001000                           144  DMMINIT
00001000                           145  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
00001000                           146  ; INPUT    - NONE
00001000                           147  ; OUTPUT   - NONE
00001000                           148  ; MODIFIES - NONE
00001000                           149  ; -----------------------------------------------------------------------------
00001000  48E7 8080                150              MOVEM.L D0/A0,-(A7)
00001004  41F9 00001940            151              LEA     DMMDATA,A0
0000100A  303C 0031                152              MOVE.W  #DMMBNUM-1,D0
0000100E  30BC 0000                153  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001012  D1FC 00000040            154              ADD.L   #DMMBSIZE,A0
00001018  51C8 FFF4                155              DBRA.W  D0,.LOOP
0000101C  4CDF 0101                156              MOVEM.L (A7)+,D0/A0
00001020  4E75                     157              RTS
00001022                           158  
00001022                           159  ; -----------------------------------------------------------------------------
00001022                           160  DMMFIRST
00001022                           161  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001022                           162  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001022                           163  ; INPUT    - NONE
00001022                           164  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001022                           165  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001022                           166  ; -----------------------------------------------------------------------------
00001022  41F9 00001940            167              LEA     DMMDATA,A0
00001028  4A58                     168  DMMFRLOP    TST.W   (A0)+
0000102A  6600 0016                169              BNE     DMMFRFND
0000102E  D1FC 0000003E            170              ADD.L   #DMMBSIZE-2,A0
00001034  B1FC 000025BF            171  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
0000103A  6DEC                     172              BLT     DMMFRLOP
0000103C  207C 00000000            173              MOVE.L  #0,A0
00001042  4E75                     174  DMMFRFND    RTS
00001044                           175  
00001044                           176  ; -----------------------------------------------------------------------------
00001044                           177  DMMNEXT
00001044                           178  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001044                           179  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001044                           180  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001044                           181  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001044                           182  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001044                           183  ; -----------------------------------------------------------------------------
00001044  2F00                     184              MOVE.L  D0,-(A7)
00001046  2008                     185              MOVE.L  A0,D0
00001048  C0BC FFFFFFC0            186              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000104E  0680 00000040            187              ADD.L   #DMMBSIZE,D0
00001054  2040                     188              MOVE.L  D0,A0
00001056  201F                     189              MOVE.L  (A7)+,D0
00001058  60DA                     190              BRA     DMMFRCOM
0000105A                           191  
0000105A                           192  ; -----------------------------------------------------------------------------
0000105A                           193  DMMFRSTO
0000105A                           194  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000105A                           195  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000105A                           196  ; INPUT    - D0.W : ID TO SEARCH
0000105A                           197  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000105A                           198  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000105A                           199  ; -----------------------------------------------------------------------------
0000105A  41F9 00001940            200              LEA     DMMDATA,A0
00001060  B058                     201  DMMFLOOP    CMP.W   (A0)+,D0
00001062  6700 0016                202              BEQ     DMMFFND
00001066  D1FC 0000003E            203              ADD.L   #DMMBSIZE-2,A0
0000106C  B1FC 000025BF            204  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001072  6DEC                     205              BLT     DMMFLOOP
00001074  207C 00000000            206              MOVE.L  #0,A0
0000107A  4E75                     207  DMMFFND     RTS
0000107C                           208  
0000107C                           209  ; -----------------------------------------------------------------------------
0000107C                           210  DMMNEXTO
0000107C                           211  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000107C                           212  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000107C                           213  ; INPUT    - D0.W : ID TO SEARCH
0000107C                           214  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000107C                           215  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000107C                           216  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000107C                           217  ; -----------------------------------------------------------------------------
0000107C  2F00                     218              MOVE.L  D0,-(A7)
0000107E  2008                     219              MOVE.L  A0,D0
00001080  C0BC FFFFFFC0            220              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001086  0680 00000040            221              ADD.L   #DMMBSIZE,D0
0000108C  2040                     222              MOVE.L  D0,A0
0000108E  201F                     223              MOVE.L  (A7)+,D0
00001090  60DA                     224              BRA     DMMFCOM
00001092                           225  
00001092                           226  ; -----------------------------------------------------------------------------
00001092                           227  DMMALLOC
00001092                           228  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001092                           229  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001092                           230  ; INPUT    - D0.W : ID TO ASSIGN
00001092                           231  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001092                           232  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001092                           233  ; -----------------------------------------------------------------------------
00001092  3F00                     234              MOVE.W  D0,-(A7)
00001094  4240                     235              CLR.W   D0
00001096  4EB8 105A                236              JSR     DMMFRSTO
0000109A  301F                     237              MOVE.W  (A7)+,D0
0000109C  B1FC 00000000            238              CMP.L   #0,A0
000010A2  6700 0006                239              BEQ     .END
000010A6  3140 FFFE                240              MOVE.W  D0,-2(A0)
000010AA  4E75                     241  .END        RTS
000010AC                           242  
000010AC                           243  ; -----------------------------------------------------------------------------
000010AC                           244  DMMFREE
000010AC                           245  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000010AC                           246  ; SYSTEM (0)
000010AC                           247  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000010AC                           248  ; OUTPUT   - NONE
000010AC                           249  ; MODIFIES - NONE
000010AC                           250  ; -----------------------------------------------------------------------------
000010AC  48E7 8080                251              MOVEM.L D0/A0,-(A7)
000010B0  2008                     252              MOVE.L  A0,D0
000010B2  C0BC FFFFFFC0            253              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000010B8  2040                     254              MOVE.L  D0,A0
000010BA  4250                     255              CLR.W   (A0)
000010BC  4CDF 0101                256              MOVEM.L (A7)+,D0/A0
000010C0  4E75                     257              RTS
000010C0  4E75                     258  -------------------- end include --------------------
000010C2                           259              INCLUDE "LIB/AGLCODE.X68"
000010C2                           260  ; =============================================================================
000010C2                           261  ; AGENT MANAGEMENT
000010C2                           262  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000010C2                           263  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000010C2                           264  ; +4 - LONG : PLOT SUBROUTINE POINTER
000010C2                           265  ; +8:END    : DATA (AGENT SPECIFIC)
000010C2                           266  ; =============================================================================
000010C2                           267  
000010C2                           268  ; -----------------------------------------------------------------------------
000010C2                           269  AGLADD
000010C2                           270  ; CREATES A NEW AGENT
000010C2                           271  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000010C2                           272  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000010C2                           273  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000010C2                           274  ;            D0 - AGENT TYPE (USED AS OWNER BY DMM)
000010C2                           275  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000010C2                           276  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000010C2                           277  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000010C2                           278  ; OUTPUT   - NONE
000010C2                           279  ; MODIFIES - NONE
000010C2                           280  ; -----------------------------------------------------------------------------
000010C2  2F08                     281              MOVE.L  A0,-(A7)
000010C4  4EB8 1092                282              JSR     DMMALLOC
000010C8  B1FC 00000000            283              CMP.L   #0,A0
000010CE  6700 0008                284              BEQ     .END
000010D2  20CA                     285              MOVE.L  A2,(A0)+
000010D4  20CB                     286              MOVE.L  A3,(A0)+
000010D6  4E91                     287              JSR     (A1)
000010D8  205F                     288  .END        MOVE.L  (A7)+,A0
000010DA  4E75                     289              RTS
000010DC                           290  
000010DC                           291  ; -----------------------------------------------------------------------------
000010DC                           292  AGLUPD
000010DC                           293  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000010DC                           294  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000010DC                           295  ; INPUT    - NONE
000010DC                           296  ; OUTPUT   - NONE
000010DC                           297  ; MODIFIES - NONE
000010DC                           298  ; -----------------------------------------------------------------------------
000010DC  48E7 00C0                299              MOVEM.L A0-A1,-(A7)
000010E0  4EB8 1022                300              JSR     DMMFIRST
000010E4  B1FC 00000000            301  .LOOP       CMP.L   #0,A0
000010EA  6700 000E                302              BEQ     .END
000010EE  2250                     303              MOVE.L  (A0),A1
000010F0  5088                     304              ADD.L   #8,A0
000010F2  4E91                     305              JSR     (A1)
000010F4  4EB8 1044                306              JSR     DMMNEXT
000010F8  60EA                     307              BRA     .LOOP
000010FA  4CDF 0300                308  .END        MOVEM.L (A7)+,A0-A1
000010FE  4E75                     309              RTS
00001100                           310  
00001100                           311  ; -----------------------------------------------------------------------------
00001100                           312  AGLPLOT
00001100                           313  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001100                           314  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001100                           315  ; INPUT    - NONE
00001100                           316  ; OUTPUT   - NONE
00001100                           317  ; MODIFIES - NONE
00001100                           318  ; -----------------------------------------------------------------------------
00001100  48E7 00C0                319              MOVEM.L A0-A1,-(A7)
00001104  4EB8 1022                320              JSR     DMMFIRST
00001108  B1FC 00000000            321  .LOOP       CMP.L   #0,A0
0000110E  6700 0010                322              BEQ     .END
00001112  2268 0004                323              MOVE.L  4(A0),A1
00001116  5088                     324              ADD.L   #8,A0
00001118  4E91                     325              JSR     (A1)
0000111A  4EB8 1044                326              JSR     DMMNEXT
0000111E  60E8                     327              BRA     .LOOP
00001120  4CDF 0300                328  .END        MOVEM.L (A7)+,A0-A1
00001124  4E75                     329              RTS
00001126                           330  
00001126                           331  ; -----------------------------------------------------------------------------
00001126                           332  AGLCLEAN
00001126                           333  ; KILLS EVERY AGENT ON AGENLIST
00001126                           334  ; INPUT     - NONE
00001126                           335  ; OUTPUT    - KILLS EVERY AGENT ON AGENTLIST
00001126                           336  ; MODIFIES  - NONE
00001126                           337  ; -----------------------------------------------------------------------------
00001126  48E7 00C0                338              MOVEM.L A0-A1,-(A7)
0000112A  4EB8 1022                339  .LOOP       JSR     DMMFIRST
0000112E  B1FC 00000000            340              CMP.L   #0,A0
00001134  6700 000A                341              BEQ     .END
00001138  4EB9 000010AC            342              JSR     AGLKILL
0000113E  60EA                     343              BRA     .LOOP
00001140  4CDF 0300                344  .END        MOVEM.L (A7)+,A0-A1
00001144  4E75                     345              RTS
00001146                           346  
00001146                           347              
00001146                           348  
00001146                           349  
00001146                           350  ; -----------------------------------------------------------------------------
00001146  =000010AC                351  AGLKILL     EQU     DMMFREE
00001146                           352  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001146                           353  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001146                           354  ; OUTPUT   - NONE
00001146                           355  ; MODIFIES - NONE
00001146                           356  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001146                           357  ; -----------------------------------------------------------------------------
00001146                           358  
00001146                           359  
00001146                           360  -------------------- end include --------------------
00001146                           361              INCLUDE "LIB/UTLCODE.X68"
00001146                           362  ; =============================================================================
00001146                           363  ; UTILITY CODE
00001146                           364  ; =============================================================================
00001146                           365  
00001146                           366  ; -----------------------------------------------------------------------------
00001146                           367  UTLINIT
00001146                           368  ; INITIALIZES UTILITY CODE
00001146                           369  ; INPUT    - NONE
00001146                           370  ; OUTPUT   - NONE
00001146                           371  ; MODIFIES - NONE
00001146                           372  ; -----------------------------------------------------------------------------
00001146  48E7 C000                373              MOVEM.L D0-D1,-(A7)
0000114A  103C 0008                374              MOVE.B  #8,D0
0000114E  4E4F                     375              TRAP    #15
00001150  13C1 000018F0            376              MOVE.B  D1,(UTLRNDIX)
00001156  4CDF 0003                377              MOVEM.L (A7)+,D0-D1
0000115A  4E75                     378              RTS
0000115C                           379              
0000115C                           380  ; -----------------------------------------------------------------------------
0000115C                           381  UTLPRINT
0000115C                           382  ; PRINT SCREEN CENTERED TEXT
0000115C                           383  ; INPUT    : A0 POINTER TO ZERO-TERMINATED STRING
0000115C                           384  ;            D0.B SCREEN ROW TO PRINT TEXT
0000115C                           385  ; OUTPUT   : D0.B NEXT ROW
0000115C                           386  ; MODIFIES : NONE (ASIDE OF OUTPUT)
0000115C                           387  ; -----------------------------------------------------------------------------
0000115C  48E7 C0C0                388              MOVEM.L D0-D1/A0-A1,-(A7)
00001160  4201                     389              CLR.B   D1
00001162  2248                     390              MOVE.L  A0,A1
00001164  4A18                     391  .LOOP       TST.B   (A0)+
00001166  6700 0006                392              BEQ     .ENDLOOP
0000116A  5201                     393              ADDQ.B  #1,D1
0000116C  60F6                     394              BRA     .LOOP
0000116E  E209                     395  .ENDLOOP    LSR.B   #1,D1
00001170  0401 0028                396              SUB.B   #(SCRWIDTH/UTLCHRWD)/2,D1
00001174  4401                     397              NEG.B   D1
00001176  E141                     398              ASL.W   #8,D1
00001178  8240                     399              OR.W    D0,D1
0000117A  103C 000B                400              MOVE.B  #11,D0
0000117E  4E4F                     401              TRAP    #15
00001180  103C 000D                402              MOVE.B  #13,D0
00001184  4E4F                     403              TRAP    #15
00001186  4CDF 0303                404              MOVEM.L (A7)+,D0-D1/A0-A1
0000118A  5200                     405              ADDQ.B  #1,D0
0000118C  4E75                     406              RTS
0000118E                           407  
0000118E                           408  ; -----------------------------------------------------------------------------
0000118E                           409  UTLRAND
0000118E                           410  ; PROVIDES A PSEUDO-RANDOM BYTE
0000118E                           411  ; INPUT    - NONE
0000118E                           412  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
0000118E                           413  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000118E                           414  ; -----------------------------------------------------------------------------
0000118E  2F08                     415              MOVE.L  A0,-(A7)
00001190  41F9 000011AC            416              LEA     .RANDVEC,A0
00001196  4280                     417              CLR.L   D0
00001198  1039 000018F0            418              MOVE.B  (UTLRNDIX),D0
0000119E  1030 0800                419              MOVE.B  (A0,D0.L),D0
000011A2  5239 000018F0            420              ADDQ.B  #1,(UTLRNDIX)
000011A8  205F                     421              MOVE.L  (A7)+,A0
000011AA  4E75                     422              RTS
000011AC                           423  
000011AC                           424  
000011AC= A2 EE 9A 0C F5 24 ...    425  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000011B4= 2A A3 51 26 E0 AC ...    426              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000011BC= 75 51 CA FD 33 EB ...    427              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000011C4= 60 CC E7 B8 9A EB ...    428              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000011CC= 1D 76 B5 95 B0 89 ...    429              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000011D4= 39 15 48 C9 6E CA ...    430              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000011DC= 43 E7 E2 7C 37 25 ...    431              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000011E4= E9 94 CE E9 E4 52 ...    432              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000011EC= 37 6D 9A 84 A2 28 ...    433              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000011F4= 19 E2 C6 77 80 D4 ...    434              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000011FC= 0A 5A 32 67 33 C2 ...    435              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001204= 59 80 DC 0E 57 FC ...    436              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
0000120C= 8A AB BC F7 07 4D ...    437              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001214= EF D5 77 6E 1E BB ...    438              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
0000121C= D6 E0 2A 8F BD 28 ...    439              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001224= 13 4F 66 EC 0A 64 ...    440              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
0000122C= 56 52 9A 16 9B 90 ...    441              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001234= 06 8A A4 F7 01 DA ...    442              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
0000123C= F2 E7 77 28 B1 76 ...    443              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001244= A4 42 E3 81 B1 67 ...    444              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
0000124C= BF CE FA 16 BF 38 ...    445              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001254= D1 8B 50 0C 5F 49 ...    446              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000125C= DE 4C 14 A2 40 DC ...    447              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001264= B6 9B 0A 38 5D AB ...    448              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000126C= E2 1B DD 75 15 82 ...    449              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001274= 8A 26 51 30 9F 47 ...    450              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
0000127C= 1E 8A BB 71 C6 6E ...    451              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001284= 9F 47 E5 34 94 27 ...    452              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
0000128C= 7D 06 D6 BA 30 0F ...    453              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001294= EC 7F 7E 03 CF 2D ...    454              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
0000129C= 94 5B 23 F2 8B CD ...    455              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000012A4= 74 33 EC B9 0F D5 ...    456              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000012AC                           457  
000012AC                           458  -------------------- end include --------------------
000012AC                           459              ; SYSTEM INCLUDES
000012AC                           460              INCLUDE "SYSTEM.X68"
000012AC                           461  ; =============================================================================
000012AC                           462  ; SYSTEM
000012AC                           463  ; =============================================================================
000012AC                           464  
000012AC                           465  ; -----------------------------------------------------------------------------
000012AC                           466  SYSINIT
000012AC                           467  ; INITIALIZE SYSTEM
000012AC                           468  ; INPUT     : NONE
000012AC                           469  ; OUTPUT    : NONE
000012AC                           470  ; MODIFIES  : NONE
000012AC                           471  ; -----------------------------------------------------------------------------
000012AC                           472              ; INSTALL TRAPS AND INTERRUPTIONS
000012AC  21FC 0000139A 0080       473              MOVE.L  #SCRPLOT,($80+SCRUPDTN*4)
000012B4  21FC 000013D0 0084       474              MOVE.L  #KBDUPD,($80+KBDUPDTN*4)
000012BC  21FC 00001344 0088       475              MOVE.L  #SNDPLAY,($80+SNDPLTN*4)
000012C4  21FC 000013B4 0064       476              MOVE.L  #SCRTIM,($60+SCRINTN*4)
000012CC                           477              
000012CC  4EB9 000013C2            478              JSR     KBDINIT
000012D2  4EB9 000012EA            479              JSR     SNDINIT
000012D8  4EB9 00001356            480              JSR     SCRINIT
000012DE  4EB8 1000                481              JSR     DMMINIT
000012E2                           482              
000012E2                           483              ; SET USER MODE AND ALLOW INTERRUPTIONS
000012E2  40E7                     484              MOVE.W  SR,-(A7)
000012E4  0257 D8FF                485              ANDI.W  #$D8FF,(A7)
000012E8  4E73                     486              RTE
000012EA                           487              
000012EA                           488  ; -----------------------------------------------------------------------------
000012EA                           489  SNDINIT
000012EA                           490  ; INITIALIZES SOUND SYSTEM
000012EA                           491  ; INPUT     : NONE
000012EA                           492  ; OUTPUT    : NONE
000012EA                           493  ; MODIFIES  : NONE
000012EA                           494  ; -----------------------------------------------------------------------------
000012EA  48E7 C0C0                495              MOVEM.L D0-D1/A0-A1,-(A7)
000012EE                           496              
000012EE  4201                     497              CLR.B   D1
000012F0  41F9 00001334            498              LEA     .SNDLIST,A0
000012F6  2018                     499  .LOOP       MOVE.L  (A0)+,D0
000012F8  6700 000E                500              BEQ     .DONE
000012FC  2240                     501              MOVE.L  D0,A1
000012FE  103C 0047                502              MOVE.B  #71,D0
00001302  4E4F                     503              TRAP    #15
00001304  5201                     504              ADDQ.B  #1,D1
00001306  60EE                     505              BRA     .LOOP
00001308                           506              
00001308  4CDF 0303                507  .DONE       MOVEM.L (A7)+,D0-D1/A0-A1
0000130C  4E75                     508              RTS
0000130E                           509              
0000130E= 53 4E 44 2F 44 49 ...    510  .SNDDIE     DC.B    'SND/DIE.wav',0
0000131A= 53 4E 44 2F 4A 55 ...    511  .SNDJUMP    DC.B    'SND/JUMP.wav',0
00001327= 53 4E 44 2F 53 43 ...    512  .SNDSCO     DC.B    'SND/SCO.wav',0
00001334                           513              DS.W    0                       ; WORD ALIGN
00001334= 0000130E 0000131A ...    514  .SNDLIST    DC.L    .SNDDIE,.SNDJUMP,.SNDSCO,0
00001344                           515              
00001344                           516  ; ------------------------------------------------------------------------------
00001344                           517  SNDPLAY
00001344                           518  ; PLAY SOUND
00001344                           519  ; INPUT    : D7 SOUND ID
00001344                           520  ; OUTPUT   : NONE
00001344                           521  ; MODIFIES : NONE
00001344                           522  ; ------------------------------------------------------------------------------
00001344  48A7 C000                523              MOVEM.W D0-D1,-(A7)
00001348                           524              
00001348  103C 0048                525              MOVE.B  #72,D0
0000134C  1207                     526              MOVE.B  D7,D1
0000134E  4E4F                     527              TRAP    #15
00001350                           528              
00001350  4C9F 0003                529              MOVEM.W (A7)+,D0-D1
00001354  4E73                     530              RTE
00001356                           531  
00001356                           532  ; -----------------------------------------------------------------------------
00001356                           533  SCRINIT
00001356                           534  ; INIT SCREEN. SET SCREEN RESOLUTION, SET WINDOWED MODE, CLEAR SCREEN,
00001356                           535  ; ENABLE DOUBLE BUFFER, ENABLE TIMED INTERRUPT.
00001356                           536  ; INPUT     : NONE
00001356                           537  ; OUTPUT    : NONE
00001356                           538  ; MODIFIES  : NONE
00001356                           539  ; -----------------------------------------------------------------------------
00001356                           540  
00001356  48E7 C000                541              MOVEM.L D0-D1,-(A7)
0000135A                           542              
0000135A                           543              ; SET SCREEN RESOLUTION
0000135A  103C 0021                544              MOVE.B  #33,D0
0000135E  223C 028001E0            545              MOVE.L  #SCRWIDTH<<16|SCRHEIGH,D1
00001364  4E4F                     546              TRAP    #15
00001366                           547              
00001366                           548              ; SET WINDOWED MODE
00001366  7201                     549              MOVE.L  #1,D1
00001368  4E4F                     550              TRAP    #15
0000136A                           551              
0000136A                           552              ; CLEAR SCREEN
0000136A  103C 000B                553              MOVE.B  #11,D0
0000136E  323C FF00                554              MOVE.W  #$FF00,D1
00001372  4E4F                     555              TRAP    #15
00001374                           556              
00001374                           557              ; ENABLE DOUBLE BUFFER
00001374  103C 005C                558              MOVE.B  #92,D0
00001378  123C 0011                559              MOVE.B  #17,D1
0000137C  4E4F                     560              TRAP    #15
0000137E                           561              
0000137E                           562              ; ENABLE TIMED INTERRUPT
0000137E  103C 0020                563              MOVE.B  #32,D0
00001382  123C 0006                564              MOVE.B  #6,D1
00001386  143C 0081                565              MOVE.B  #$80|SCRINTN,D2
0000138A  7610                     566              MOVE.L  #1000/SCRFPS,D3
0000138C  4E4F                     567              TRAP    #15
0000138E                           568              
0000138E                           569              ; CLEAR INTERRUPT COUNTER
0000138E  4279 000018F4            570              CLR.W   (SCRINTCT)
00001394                           571              
00001394  4CDF 0003                572              MOVEM.L (A7)+,D0-D1
00001398  4E75                     573              RTS
0000139A                           574              
0000139A                           575  ; -----------------------------------------------------------------------------
0000139A                           576  SCRPLOT
0000139A                           577  ; UPDATES DOUBLE BUFFER
0000139A                           578  ; INPUT    : NONE
0000139A                           579  ; OUTPUT   : NONE
0000139A                           580  ; MODIFIES : NONE
0000139A                           581  ; -----------------------------------------------------------------------------
0000139A  48A7 C000                582              MOVEM.W D0-D1,-(A7)
0000139E                           583              
0000139E                           584              ; SWITCH BUFFERS
0000139E  103C 005E                585              MOVE.B  #94,D0
000013A2  4E4F                     586              TRAP    #15
000013A4                           587              
000013A4                           588              ; CLEAN HIDDEN BUFFER
000013A4  103C 000B                589              MOVE.B  #11,D0
000013A8  323C FF00                590              MOVE.W  #$FF00,D1
000013AC  4E4F                     591              TRAP    #15
000013AE  4C9F 0003                592              MOVEM.W (A7)+,D0-D1
000013B2  4E73                     593              RTE
000013B4                           594  
000013B4                           595  ; -----------------------------------------------------------------------------
000013B4                           596  SCRTIM
000013B4                           597  ; TIMED INTERRUPT SERVICE ROUTINE, COUNTS TIME FALLING
000013B4                           598  ; INPUT     : NONE
000013B4                           599  ; OUTPUT    : NONE
000013B4                           600  ; MODIFIES  : NONE
000013B4                           601  ; -----------------------------------------------------------------------------
000013B4  5239 000018F4            602              ADDQ.B  #1,(SCRINTCT)
000013BA  5239 000018F5            603              ADDQ.B  #1,(SCRCYCCT)
000013C0  4E73                     604              RTE
000013C2                           605              
000013C2                           606  ; -----------------------------------------------------------------------------
000013C2                           607  KBDINIT
000013C2                           608  ; INIT KEYBOARD
000013C2                           609  ; INPUT     : NONE
000013C2                           610  ; OUTPUT    : NONE
000013C2                           611  ; MODIFIES  : NONE
000013C2                           612  ; -----------------------------------------------------------------------------
000013C2  4239 000018F2            613              CLR.B   (KBDVAL)
000013C8  4239 000018F3            614              CLR.B   (KBDEDGE)
000013CE  4E75                     615              RTS
000013D0                           616              
000013D0                           617  ; -----------------------------------------------------------------------------
000013D0                           618  KBDUPD
000013D0                           619  ; UPDATE KEYBOARD INFO
000013D0                           620  ; 0 -> SPACE
000013D0                           621  ; INPUT     : NONE
000013D0                           622  ; OUTPUT    : NONE
000013D0                           623  ; MODIFIES  : NONE
000013D0                           624  ; -----------------------------------------------------------------------------
000013D0  48E7 F000                625              MOVEM.L D0-D3,-(A7)
000013D4                           626              
000013D4                           627              ; READ KEYBOARD
000013D4  103C 0013                628              MOVE.B  #19,D0
000013D8  223C 00005020            629              MOVE.L  #KBDP<<8|KBDSPACE,D1
000013DE  4E4F                     630              TRAP    #15
000013E0                           631              
000013E0                           632              ; CONVERT TO DESIRED FORMAT
000013E0  4EB9 00001402            633              JSR     .PACK
000013E6                           634  
000013E6                           635              ; COMPUTE KBDEDGE
000013E6  1039 000018F2            636              MOVE.B  (KBDVAL),D0
000013EC  4600                     637              NOT.B   D0
000013EE  C042                     638              AND.W   D2,D0
000013F0  13C0 000018F3            639              MOVE.B  D0,(KBDEDGE)
000013F6                           640              
000013F6                           641              ; STORE KBDVAL
000013F6  13C2 000018F2            642              MOVE.B  D2,(KBDVAL)
000013FC                           643              
000013FC  4CDF 000F                644              MOVEM.L (A7)+,D0-D3
00001400  4E73                     645              RTE
00001402                           646  
00001402  363C 0003                647  .PACK       MOVE.W  #3,D3
00001406  E189                     648  .LOOP       LSL.L   #8,D1
00001408  E312                     649              ROXL.B  #1,D2
0000140A  51CB FFFA                650              DBRA.W  D3,.LOOP
0000140E  4E75                     651              RTS
00001410                           652  
00001410                           653      
00001410                           654  
00001410                           655  
00001410                           656  
00001410                           657  
00001410                           658  
00001410                           659  
00001410                           660  
00001410                           661  
00001410                           662  
00001410                           663  -------------------- end include --------------------
00001410                           664              ; STATES INCLUDES
00001410                           665              INCLUDE "STATES.X68"
00001410                           666  ; =============================================================================
00001410                           667  ; GAME STATE MANAGEMENT
00001410                           668  ; =============================================================================
00001410                           669  
00001410                           670  ; -----------------------------------------------------------------------------
00001410                           671  STAINIT
00001410                           672  ; INITALIZES THE STATE MANAGER
00001410                           673  ; INPUT    - NONE
00001410                           674  ; OUTPUT   - NONE
00001410                           675  ; MODIFIES - NONE
00001410                           676  ; -----------------------------------------------------------------------------
00001410  33FC FFFF 000018EC       677              MOVE.W  #STANONE,(STACUR)
00001418  4279 000018EE            678              CLR.W   (STANEXT)
0000141E  4E75                     679              RTS
00001420                           680  
00001420                           681  ; -----------------------------------------------------------------------------
00001420                           682  STAUPD
00001420                           683  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001420                           684  ; INPUT    - NONE
00001420                           685  ; OUTPUT   - NONE
00001420                           686  ; MODIFIES - NONE
00001420                           687  ; -----------------------------------------------------------------------------
00001420  48E7 8080                688              MOVEM.L D0/A0,-(A7)
00001424  4280                     689              CLR.L   D0
00001426  3039 000018EE            690              MOVE.W  (STANEXT),D0
0000142C  B079 000018EC            691              CMP.W   (STACUR),D0
00001432  6700 0012                692              BEQ     .DOUPD
00001436  33C0 000018EC            693              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
0000143C  E588                     694              LSL.L   #2,D0
0000143E  2040                     695              MOVE.L  D0,A0
00001440  2068 145E                696              MOVE.L  .INITBL(A0),A0
00001444  4E90                     697              JSR     (A0)
00001446  4280                     698  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001448  3039 000018EC            699              MOVE.W  (STACUR),D0
0000144E  E588                     700              LSL.L   #2,D0
00001450  2040                     701              MOVE.L  D0,A0
00001452  2068 1472                702              MOVE.L  .UPDTBL(A0),A0
00001456  4E90                     703              JSR     (A0)
00001458  4CDF 0101                704              MOVEM.L (A7)+,D0/A0
0000145C  4E75                     705              RTS
0000145E= 000014B8 000014D8 ...    706  .INITBL     DC.L    ISCINIT,INSINIT,GAMEINIT,PAUSINIT,GOVINIT
00001472= 000014BE 000014DA ...    707  .UPDTBL     DC.L    ISCUPD,INSUPD,GAMEUPD,PAUSUPD,GOVUPD
00001486                           708  
00001486                           709  ; -----------------------------------------------------------------------------
00001486                           710  STAPLOT
00001486                           711  ; PERFORMS STATE PLOT
00001486                           712  ; INPUT    - NONE
00001486                           713  ; OUTPUT   - NONE
00001486                           714  ; MODIFIES - NONE
00001486                           715  ; -----------------------------------------------------------------------------
00001486  48E7 8080                716              MOVEM.L D0/A0,-(A7)
0000148A  4280                     717              CLR.L   D0
0000148C  3039 000018EC            718              MOVE.W  (STACUR),D0
00001492  E588                     719              LSL.L   #2,D0
00001494  2040                     720              MOVE.L  D0,A0
00001496  2068 14A2                721              MOVE.L  .PLTTBL(A0),A0
0000149A  4E90                     722              JSR     (A0)
0000149C  4CDF 0101                723              MOVEM.L (A7)+,D0/A0
000014A0  4E75                     724              RTS
000014A2= 000014D6 000014DC ...    725  .PLTTBL     DC.L    ISCPLOT,INSPLOT,GAMEPLOT,PAUSPLOT,GOVPLOT
000014B6                           726  
000014B6                           727  ; -----------------------------------------------------------------------------
000014B6                           728  STAEMPTY
000014B6                           729  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000014B6                           730  ; INPUT    - NONE
000014B6                           731  ; OUTPUT   - NONE
000014B6                           732  ; MODIFIES - NONE
000014B6                           733  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000014B6                           734  ; -----------------------------------------------------------------------------
000014B6  4E75                     735              RTS
000014B8                           736  
000014B8                           737  
000014B8                           738  
000014B8                           739  
000014B8                           740  
000014B8                           741  
000014B8                           742  
000014B8                           743  
000014B8                           744  -------------------- end include --------------------
000014B8                           745              INCLUDE "INTRO.X68"
000014B8                           746  ; =============================================================================
000014B8                           747  ; INTRO SCREEN MANAGEMENT
000014B8                           748  ; =============================================================================
000014B8                           749  
000014B8                           750  ; ------------------------------------------------------------------------------
000014B8                           751  ISCINIT
000014B8                           752  ; INTRO SCREEN INIT
000014B8                           753  ; INPUT    : NONE
000014B8                           754  ; OUTPUT   : NONE
000014B8                           755  ; MODIFIES : NONE
000014B8                           756  ; ------------------------------------------------------------------------------
000014B8  4EB8 1126                757              JSR AGLCLEAN
000014BC  4E75                     758              RTS
000014BE                           759  
000014BE                           760  ; ------------------------------------------------------------------------------
000014BE                           761  ISCUPD
000014BE                           762  ; INTRO SCREEN UPDATE
000014BE                           763  ; INPUT    : NONE
000014BE                           764  ; OUTPUT   : NONE
000014BE                           765  ; MODIFIES : NONE
000014BE                           766  ; ------------------------------------------------------------------------------
000014BE                           767  
000014BE  1039 000018F3            768              MOVE.B  (KBDEDGE),D0
000014C4  C03C 0001                769              AND.B   #1,D0
000014C8  6700 000A                770              BEQ     .CONT
000014CC  33FC 0002 000018EE       771              MOVE.W  #STAGAME,(STANEXT)      
000014D4                           772  .CONT
000014D4  4E75                     773              RTS
000014D6                           774  
000014D6                           775  ; ------------------------------------------------------------------------------
000014D6                           776  ISCPLOT
000014D6                           777  ; INTRO SCREEN PLOT
000014D6                           778  ; INPUT    : NONE
000014D6                           779  ; OUTPUT   : NONE
000014D6                           780  ; MODIFIES : NONE
000014D6                           781  ; ------------------------------------------------------------------------------
000014D6  4E75                     782              RTS
000014D8                           783  
000014D8                           784  
000014D8                           785  
000014D8                           786  
000014D8                           787  
000014D8                           788  
000014D8                           789  
000014D8                           790  -------------------- end include --------------------
000014D8                           791              INCLUDE "INSTRUCTIONS.X68"
000014D8                           792  ; =============================================================================
000014D8                           793  ; INSTRUCTION SCREEN MANAGEMENT
000014D8                           794  ; =============================================================================
000014D8                           795  
000014D8                           796  ; ==============================================================================
000014D8                           797  ; INSTRUCTIONS SCREEN
000014D8                           798  ; ==============================================================================
000014D8                           799  
000014D8                           800  ; ------------------------------------------------------------------------------
000014D8                           801  INSINIT
000014D8                           802  ; INSTRUCTIONS SCREEN INIT
000014D8                           803  ; INPUT    : NONE
000014D8                           804  ; OUTPUT   : NONE
000014D8                           805  ; MODIFIES : NONE
000014D8                           806  ; ------------------------------------------------------------------------------
000014D8  4E75                     807              RTS
000014DA                           808  
000014DA                           809  ; ------------------------------------------------------------------------------
000014DA                           810  INSUPD
000014DA                           811  ; INSTRUCTIONS SCREEN UPDATE
000014DA                           812  ; INPUT    : NONE
000014DA                           813  ; OUTPUT   : NONE
000014DA                           814  ; MODIFIES : NONE
000014DA                           815  ; ------------------------------------------------------------------------------
000014DA  4E75                     816              RTS
000014DC                           817  
000014DC                           818  ; ------------------------------------------------------------------------------
000014DC                           819  INSPLOT
000014DC                           820  ; INSTRUCTIONS SCREEN PLOT
000014DC                           821  ; INPUT    : NONE
000014DC                           822  ; OUTPUT   : NONE
000014DC                           823  ; MODIFIES : NONE
000014DC                           824  ; ------------------------------------------------------------------------------
000014DC  4E75                     825              RTS
000014DE                           826  
000014DE                           827  
000014DE                           828  
000014DE                           829  
000014DE                           830  
000014DE                           831  
000014DE                           832  
000014DE                           833  
000014DE                           834  
000014DE                           835  -------------------- end include --------------------
000014DE                           836              INCLUDE "GAME.X68"
000014DE                           837  ; =============================================================================
000014DE                           838  ; GAME MANAGEMENT
000014DE                           839  ; =============================================================================
000014DE                           840  
000014DE                           841  ; -----------------------------------------------------------------------------
000014DE                           842  GAMEINIT
000014DE                           843  ; INITIALIZES GAME.
000014DE                           844  ; INPUT    : NONE
000014DE                           845  ; OUTPUT   : NONE
000014DE                           846  ; MODIFIES : NONE
000014DE                           847  ; ------------------------------------------------------------------------------        
000014DE                           848  
000014DE  4EB9 000015C4            849              JSR     BIRDINIT
000014E4  4EB9 000017AC            850              JSR     SCOINIT
000014EA  13F9 000018F6 000018F5   851              MOVE.B  (GAMCYCCT),(SCRCYCCT)
000014F4  4E75                     852              RTS
000014F6                           853              
000014F6                           854  ; -----------------------------------------------------------------------------
000014F6                           855  GAMEUPD
000014F6                           856  ; UPDATES GAME.
000014F6                           857  ; INPUT     : NONE
000014F6                           858  ; OUTPUT    : NONE
000014F6                           859  ; MODIFIES  : NONE
000014F6                           860  ; -----------------------------------------------------------------------------
000014F6  1F00                     861              MOVE.B  D0,-(A7)
000014F8  1039 000018F3            862              MOVE.B  (KBDEDGE),D0
000014FE  0800 0001                863              BTST    #1,D0
00001502  6700 0014                864              BEQ     .NOPAUSE
00001506  33FC 0003 000018EE       865              MOVE.W  #STAPAUSE, (STANEXT)
0000150E  13F9 000018F5 000018F6   866              MOVE.B  (SCRCYCCT),(GAMCYCCT)
00001518                           867              
00001518  4EB9 0000152C            868  .NOPAUSE    JSR     NEWPIPE
0000151E  4EB8 10DC                869              JSR     AGLUPD
00001522  4EB9 000015C6            870              JSR     BIRDUPD
00001528                           871              
00001528  101F                     872              MOVE.B  (A7)+,D0
0000152A  4E75                     873              RTS
0000152C                           874  
0000152C                           875  ; -----------------------------------------------------------------------------
0000152C                           876  NEWPIPE
0000152C                           877  ; CREATES A NEW PIPE IN CASE IT'S NECESSARY.
0000152C                           878  ; INPUT     : NONE
0000152C                           879  ; OUTPUT    : NONE
0000152C                           880  ; MODIFIES  : NONE
0000152C                           881  ; -----------------------------------------------------------------------------
0000152C                           882  
0000152C  48E7 8070                883              MOVEM.L D0/A1-A3,-(A7)
00001530                           884              
00001530  1039 000018F5            885              MOVE.B  (SCRCYCCT),D0
00001536  0200 003F                886              ANDI.B  #MASKNWPP,D0
0000153A  6600 001C                887              BNE     .GOUPD
0000153E  43F9 0000165A            888              LEA     PIPEINIT,A1
00001544  45F9 00001672            889              LEA     PIPEUPD,A2
0000154A  47F9 000016F6            890              LEA     PIPEPLOT,A3
00001550  303C 0001                891              MOVE    #PIPEAGTP,D0
00001554  4EB8 10C2                892              JSR     AGLADD
00001558                           893              
00001558  4CDF 0E01                894  .GOUPD      MOVEM.L (A7)+,D0/A1-A3
0000155C  4E75                     895              RTS
0000155E                           896  
0000155E                           897  ; -----------------------------------------------------------------------------
0000155E                           898  GAMEPLOT
0000155E                           899  ; PLOTS THE GAME.
0000155E                           900  ; INPUT     : NONE
0000155E                           901  ; OUTPUT    : NONE
0000155E                           902  ; MODIFIES  : NONE
0000155E                           903  ; -----------------------------------------------------------------------------
0000155E                           904              
0000155E  4EB9 00001800            905              JSR     SCOPLOT
00001564  4EB8 1100                906              JSR     AGLPLOT
00001568  6000 00AE                907              BRA     BIRDPLOT
0000156C                           908           
0000156C                           909  
0000156C                           910  
0000156C                           911  
0000156C                           912  
0000156C                           913  
0000156C                           914  
0000156C                           915  
0000156C                           916  
0000156C                           917  
0000156C                           918  
0000156C                           919  -------------------- end include --------------------
0000156C                           920              INCLUDE "PAUSE.X68"
0000156C                           921  ; =============================================================================
0000156C                           922  ; PAUSE SCREEN MANAGEMENT
0000156C                           923  ; =============================================================================
0000156C                           924  
0000156C                           925  ; ------------------------------------------------------------------------------
0000156C                           926  PAUSINIT
0000156C                           927  ; PAUSE SCREEN INIT
0000156C                           928  ; INPUT    : NONE
0000156C                           929  ; OUTPUT   : NONE
0000156C                           930  ; MODIFIES : NONE
0000156C                           931  ; ------------------------------------------------------------------------------
0000156C  1F00                     932              MOVE.B  D0,-(A7)
0000156E  1039 000018F3            933              MOVE.B  (KBDEDGE),D0
00001574  C03C 0002                934              AND.B   #2,D0
00001578  6700 000A                935              BEQ     .CONT
0000157C  33FC 0002 000018EE       936              MOVE.W  #STAGAME,(STANEXT)   
00001584                           937     
00001584  101F                     938  .CONT       MOVE.B  (A7)+,D0
00001586  4E75                     939              RTS
00001588                           940  
00001588                           941  ; ------------------------------------------------------------------------------
00001588                           942  PAUSUPD
00001588                           943  ; PAUSE SCREEN UPDATE
00001588                           944  ; INPUT    : NONE
00001588                           945  ; OUTPUT   : NONE
00001588                           946  ; MODIFIES : NONE
00001588                           947  ; ------------------------------------------------------------------------------
00001588  1F00                     948              MOVE.B  D0,-(A7)
0000158A  1039 000018F3            949              MOVE.B  (KBDEDGE),D0
00001590  0800 0001                950              BTST    #1,D0
00001594  6700 000A                951              BEQ     .CONT
00001598  33FC 0002 000018EE       952              MOVE.W  #STAGAME, (STANEXT)   
000015A0                           953              
000015A0  101F                     954  .CONT       MOVE.B  (A7)+,D0     
000015A2  4E75                     955              RTS
000015A4                           956  
000015A4                           957  ; ------------------------------------------------------------------------------
000015A4                           958  PAUSPLOT
000015A4                           959  ; PAUSE SCREEN PLOT
000015A4                           960  ; INPUT    : NONE
000015A4                           961  ; OUTPUT   : NONE
000015A4                           962  ; MODIFIES : NONE
000015A4                           963  ; ------------------------------------------------------------------------------
000015A4  60B8                     964              BRA     GAMEPLOT
000015A6                           965  
000015A6                           966  
000015A6                           967  
000015A6                           968  
000015A6                           969  
000015A6                           970  
000015A6                           971  
000015A6                           972  
000015A6                           973  
000015A6                           974  
000015A6                           975  -------------------- end include --------------------
000015A6                           976              INCLUDE "GOVER.X68"
000015A6                           977  ; =============================================================================
000015A6                           978  ; GAME OVER SCREEN MANAGEMENT
000015A6                           979  ; =============================================================================
000015A6                           980  
000015A6                           981  ; ------------------------------------------------------------------------------
000015A6                           982  GOVINIT
000015A6                           983  ; GAME OVER SCREEN INIT
000015A6                           984  ; INPUT    : NONE
000015A6                           985  ; OUTPUT   : NONE
000015A6                           986  ; MODIFIES : NONE
000015A6                           987  ; ------------------------------------------------------------------------------
000015A6  6000 02BE                988              BRA     SCOSAVE
000015AA                           989  
000015AA                           990  ; ------------------------------------------------------------------------------
000015AA                           991  GOVUPD
000015AA                           992  ; GAME OVER SCREEN UPDATE
000015AA                           993  ; INPUT    : NONE
000015AA                           994  ; OUTPUT   : NONE
000015AA                           995  ; MODIFIES : NONE
000015AA                           996  ; ------------------------------------------------------------------------------
000015AA  1039 000018F3            997              MOVE.B  (KBDEDGE),D0
000015B0  6700 000A                998              BEQ     .CONT
000015B4  33FC 0000 000018EE       999              MOVE.W  #STAINTRO,(STANEXT)      
000015BC                          1000  .CONT
000015BC  4E75                    1001              RTS
000015BE                          1002  
000015BE                          1003  ; ------------------------------------------------------------------------------
000015BE                          1004  GOVPLOT
000015BE                          1005  ; GAME OVER SCREEN PLOT
000015BE                          1006  ; INPUT    : NONE
000015BE                          1007  ; OUTPUT   : NONE
000015BE                          1008  ; MODIFIES : NONE
000015BE                          1009  ; ------------------------------------------------------------------------------
000015BE  4EB8 155E               1010              JSR GAMEPLOT
000015C2  4E75                    1011              RTS
000015C4                          1012  
000015C4                          1013  
000015C4                          1014  
000015C4                          1015  
000015C4                          1016  
000015C4                          1017  
000015C4                          1018  
000015C4                          1019  
000015C4                          1020  
000015C4                          1021  -------------------- end include --------------------
000015C4                          1022              ; FEATURE INCLUDES
000015C4                          1023              INCLUDE "BIRD.X68"
000015C4                          1024  ; =============================================================================
000015C4                          1025  ; BIRD MANAGEMENT
000015C4                          1026  ; =============================================================================
000015C4                          1027  
000015C4                          1028  ; -----------------------------------------------------------------------------
000015C4                          1029  BIRDINIT
000015C4                          1030  ; INITIALIZE BIRD.
000015C4                          1031  ; INPUT     : NONE 
000015C4                          1032  ; OUTPUT    : NONE
000015C4                          1033  ; MODIFIES  : NONE
000015C4                          1034  ; -----------------------------------------------------------------------------
000015C4                          1035  
000015C4  4E75                    1036              RTS
000015C6                          1037              
000015C6                          1038  ; -----------------------------------------------------------------------------
000015C6                          1039  BIRDUPD
000015C6                          1040  ; UPDATES THE BIRD.
000015C6                          1041  ; INPUT    : NONE 
000015C6                          1042  ; OUTPUT   : NONE
000015C6                          1043  ; MODIFIES : NONE
000015C6                          1044  ; -----------------------------------------------------------------------------
000015C6                          1045  
000015C6  48E7 E000               1046              MOVEM.L D0-D2,-(A7)
000015CA                          1047  
000015CA                          1048              ; UPDATE VELOCITY
000015CA  1439 000018F3           1049              MOVE.B  (KBDEDGE),D2        ; CHECK IF SHOULD JUMP
000015D0  0802 0000               1050              BTST    #0,D2
000015D4  6700 0014               1051              BEQ     .NOJUMP
000015D8                          1052              
000015D8  1E3C 0001               1053              MOVE.B  #SNDJUMP,D7         ; PLAY SOUND
000015DC  4E42                    1054              TRAP    #SNDPLTN
000015DE  33FC FFF6 000018E2      1055              MOVE.W  #JUMPVELY,(BIRDVELY)
000015E6  6000 0008               1056              BRA     .CORDUPD
000015EA                          1057              
000015EA  5279 000018E2           1058  .NOJUMP     ADDQ.W  #1,BIRDVELY          ; ACCELERATE
000015F0                          1059              
000015F0                          1060              ; UPDATE BIRD COORDINATES
000015F0  3039 000018E0           1061  .CORDUPD    MOVE.W  (BIRDPOSY),D0
000015F6  D079 000018E2           1062              ADD.W   (BIRDVELY),D0
000015FC                          1063              
000015FC                          1064              ; CHECK SCREEN COLLISIONS
000015FC  B07C 0195               1065              CMP.W   #SCRHEIGH-FLOHEIGH-BIRDRAD,D0
00001600  6D00 000A               1066              BLT     .NOCOL
00001604                          1067          
00001604                          1068              ; COLLISION BOT
00001604  33FC 0004 000018EE      1069  .COLBOT     MOVE.W  #STAGOVER,(STANEXT)
0000160C                          1070              
0000160C                          1071              ; STORE POSITION
0000160C  33C0 000018E0           1072  .NOCOL      MOVE.W  D0,(BIRDPOSY)
00001612                          1073  
00001612  4CDF 0007               1074  .DONE       MOVEM.L (A7)+,D0-D2
00001616                          1075              
00001616  4E75                    1076              RTS
00001618                          1077  
00001618                          1078  ; -----------------------------------------------------------------------------
00001618                          1079  BIRDPLOT
00001618                          1080  ; PLOT THE BIRD.
00001618                          1081  ; INPUT    : NONE 
00001618                          1082  ; OUTPUT   : NONE
00001618                          1083  ; MODIFIES : NONE
00001618                          1084  ; -----------------------------------------------------------------------------
00001618                          1085  
00001618  48E7 F800               1086              MOVEM.L D0-D4,-(A7)
0000161C                          1087  
0000161C                          1088              ; SET PEN COLOR
0000161C  103C 0050               1089              MOVE.B  #80,D0
00001620  4281                    1090              CLR.L   D1
00001622  3239 000018E4           1091              MOVE.W  (BIRDPCOL),D1
00001628  4E4F                    1092              TRAP    #15
0000162A                          1093              
0000162A                          1094              ; SET FILL COLOR
0000162A  103C 0051               1095              MOVE.B  #81,D0
0000162E  3239 000018E6           1096              MOVE.W  (BIRDFCOL),D1
00001634  4E4F                    1097              TRAP    #15
00001636                          1098  
00001636                          1099              ; DEFINE COORDINATES
00001636  323C 0091               1100              MOVE.W  #(BIRDPOSX)-BIRDRAD,D1
0000163A  363C 00AF               1101              MOVE.W  #(BIRDPOSX)+BIRDRAD,D3
0000163E  3439 000018E0           1102              MOVE.W  (BIRDPOSY),D2
00001644  3802                    1103              MOVE.W  D2,D4
00001646  0442 000F               1104              SUB.W  #BIRDRAD,D2
0000164A  0644 000F               1105              ADD.W  #BIRDRAD,D4
0000164E                          1106              
0000164E                          1107              ; DRAW CIRCLE
0000164E  103C 0058               1108              MOVE.B  #88,D0
00001652  4E4F                    1109              TRAP    #15
00001654                          1110              
00001654  4CDF 001F               1111              MOVEM.L (A7)+,D0-D4
00001658                          1112  
00001658  4E75                    1113              RTS
0000165A                          1114  
0000165A                          1115  
0000165A                          1116  
0000165A                          1117  
0000165A                          1118  
0000165A                          1119  
0000165A                          1120  
0000165A                          1121  
0000165A                          1122  
0000165A                          1123  
0000165A                          1124  
0000165A                          1125  
0000165A                          1126  -------------------- end include --------------------
0000165A                          1127              INCLUDE "PIPE.X68"
0000165A                          1128  ; =============================================================================
0000165A                          1129  ; PIPE MANAGEMENT (AGENT)
0000165A                          1130  ; PIPEPOSX (W) (A0)
0000165A                          1131  ; PIPETOPH (B) 2(A0)
0000165A                          1132  ; =============================================================================
0000165A                          1133  
0000165A                          1134  ; -----------------------------------------------------------------------------
0000165A                          1135  PIPEINIT
0000165A                          1136  ; INITIALIZE PIPE.
0000165A                          1137  ; INPUT     : A0 POINTER TO INSTANCE VARIABLES
0000165A                          1138  ; OUTPUT    : NONE
0000165A                          1139  ; MODIFIES  : NONE
0000165A                          1140  ; -----------------------------------------------------------------------------
0000165A                          1141  
0000165A  2F00                    1142              MOVE.L  D0,-(A7)
0000165C                          1143              
0000165C  30BC 0280               1144              MOVE.W  #SCRWIDTH,(A0)
00001660  4EB8 118E               1145              JSR UTLRAND
00001664  0680 00000096           1146              ADD.L   #(SCRHEIGH-PIPEGAPS-FLOHEIGH)/2,D0
0000166A  1140 0002               1147              MOVE.B  D0,2(A0)
0000166E                          1148              
0000166E  201F                    1149              MOVE.L  (A7)+,D0
00001670  4E75                    1150              RTS
00001672                          1151              
00001672                          1152  ; -----------------------------------------------------------------------------
00001672                          1153  PIPEUPD
00001672                          1154  ; UPDATES PIPE.
00001672                          1155  ; INPUT     : A0 POINTER TO INSTANCE VARIABLES
00001672                          1156  ; OUTPUT    : NONE
00001672                          1157  ; MODIFIES  : NONE
00001672                          1158  ; -----------------------------------------------------------------------------
00001672                          1159              ; UPDATE POSITION
00001672  0650 FFFB               1160              ADD.W   #PIPEVELX,(A0)
00001676                          1161  
00001676                          1162              ; CHECK AND HANDLE COLLISIONS
00001676  6000 0002               1163              BRA PIPECOLI
0000167A                          1164              
0000167A                          1165  ; -----------------------------------------------------------------------------
0000167A                          1166  PIPECOLI
0000167A                          1167  ; CHECKS AND HANDLE PIPE COLLISIONS
0000167A                          1168  ; INPUT     : A0 POINTER TO INSTANCE VARIABLE
0000167A                          1169  ; OUTPUT    : NONE
0000167A                          1170  ; MODIFIES  : NONE
0000167A                          1171  ; -----------------------------------------------------------------------------
0000167A  2F00                    1172              MOVE.L  D0,-(A7)
0000167C  2F01                    1173              MOVE.L  D1,-(A7)
0000167E                          1174           
0000167E                          1175              ; COLLISION WITH SCREEN
0000167E  3010                    1176              MOVE.W  (A0),D0
00001680  0640 0032               1177              ADD.W   #PIPEWIDT,D0
00001684  6A00 000A               1178              BPL     .NOKILL
00001688  4EB8 10AC               1179              JSR AGLKILL
0000168C  6000 0062               1180              BRA     .END
00001690                          1181              
00001690                          1182              ; COLLISION WITH BIRD
00001690  B07C 00E1               1183  .NOKILL     CMP.W   #BIRDPOSX+BIRDRAD+PIPEWIDT,D0
00001694  6A00 004C               1184              BPL     .NOCOL
00001698  B07C 0091               1185              CMP.W   #BIRDPOSX-BIRDRAD,D0
0000169C  6B00 0044               1186              BMI     .NOCOL
000016A0                          1187  
000016A0                          1188              
000016A0                          1189              ; BIRD IS IN PIPE X RANGE
000016A0  4280                    1190              CLR.L   D0
000016A2  1028 0002               1191              MOVE.B  2(A0),D0
000016A6  3239 000018E0           1192              MOVE.W  (BIRDPOSY),D1
000016AC  0441 000F               1193              SUB.W   #BIRDRAD,D1
000016B0  B041                    1194              CMP.W   D1,D0
000016B2  6A00 0014               1195              BPL     .COL
000016B6  0640 0078               1196              ADD.W   #PIPEGAPS,D0
000016BA  0641 001E               1197              ADD.W   #2*BIRDRAD,D1
000016BE  B041                    1198              CMP.W   D1,D0
000016C0  6B00 0006               1199              BMI     .COL
000016C4                          1200  
000016C4  6000 001C               1201              BRA     .NOCOL
000016C8                          1202  
000016C8                          1203              ; STOP ALL SOUNDS
000016C8  103C 004C               1204  .COL        MOVE.B  #76,D0
000016CC  7403                    1205              MOVE.L  #3,D2
000016CE  4E4F                    1206              TRAP    #15
000016D0                          1207              
000016D0  1E3C 0000               1208              MOVE.B  #SNDDIE,D7  ; PLAY DIE SOUND
000016D4  4E42                    1209              TRAP    #SNDPLTN
000016D6                          1210              
000016D6  33FC 0004 000018EE      1211              MOVE.W  #STAGOVER,(STANEXT)
000016DE                          1212              
000016DE  6000 0010               1213              BRA     .END
000016E2                          1214  
000016E2                          1215              ; SCORE INCREASE
000016E2  0C50 005F               1216  .NOCOL      CMP.W   #BIRDPOSX-PIPEWIDT-BIRDRAD,(A0)
000016E6  6600 0008               1217              BNE     .END
000016EA  4EB9 000017E2           1218              JSR     SCOINC
000016F0                          1219              
000016F0  221F                    1220  .END        MOVE.L  (A7)+,D1
000016F2  201F                    1221              MOVE.L  (A7)+,D0
000016F4  4E75                    1222              RTS
000016F6                          1223  
000016F6                          1224  ; -----------------------------------------------------------------------------
000016F6                          1225  PIPEPLOT
000016F6                          1226  ; PLOT THE PIPE.
000016F6                          1227  ; INPUT     : A0 POINTER TO INSTANCE VARIABLES
000016F6                          1228  ; OUTPUT    : NONE
000016F6                          1229  ; MODIFIES  : NONE
000016F6                          1230  ; -----------------------------------------------------------------------------
000016F6                          1231      
000016F6  48E7 F800               1232              MOVEM.L D0-D4,-(A7)
000016FA                          1233              
000016FA                          1234              ; SET PEN AND FILL COLORS
000016FA  103C 0050               1235              MOVE.B  #80,D0
000016FE  223C 00151A30           1236              MOVE.L  #PIPEPCOL,D1
00001704  4E4F                    1237              TRAP    #15
00001706  103C 0051               1238              MOVE.B  #81,D0
0000170A  223C 0020284D           1239              MOVE.L  #PIPEFCOL,D1
00001710  4E4F                    1240              TRAP    #15
00001712                          1241              
00001712                          1242              ; PLOT TOP HALF
00001712  3210                    1243              MOVE.W  (A0),D1
00001714  4242                    1244              CLR.W   D2
00001716  3601                    1245              MOVE.W  D1,D3
00001718  0643 0032               1246              ADD.W   #PIPEWIDT,D3
0000171C  4244                    1247              CLR.W   D4
0000171E  1828 0002               1248              MOVE.B  2(A0),D4
00001722  103C 0057               1249              MOVE.B  #87,D0
00001726  4E4F                    1250              TRAP    #15
00001728                          1251              
00001728                          1252              ; PLOT BOTTOM HALF
00001728  3404                    1253              MOVE.W  D4,D2
0000172A  0642 0078               1254              ADD.W   #PIPEGAPS,D2
0000172E  383C 01A4               1255              MOVE.W  #SCRHEIGH-FLOHEIGH,D4
00001732  4E4F                    1256              TRAP    #15
00001734                          1257              
00001734  4CDF 001F               1258              MOVEM.L (A7)+,D0-D4
00001738  4E75                    1259              RTS
0000173A                          1260  
0000173A                          1261  
0000173A                          1262  
0000173A                          1263  
0000173A                          1264  
0000173A                          1265  
0000173A                          1266  
0000173A                          1267  
0000173A                          1268  
0000173A                          1269  
0000173A                          1270  
0000173A                          1271  -------------------- end include --------------------
0000173A                          1272              INCLUDE "BACKGROUND.X68"
0000173A                          1273  ; =============================================================================
0000173A                          1274  ; BACKGROUND MANAGEMENT
0000173A                          1275  ; =============================================================================
0000173A                          1276  
0000173A                          1277  ; -----------------------------------------------------------------------------
0000173A                          1278  BACKPLOT
0000173A                          1279  ; DRAWS BACKGROUND
0000173A                          1280  ; INPUT     : NONE
0000173A                          1281  ; OUTPUT    : NONE
0000173A                          1282  ; MODIFIES  : NONE
0000173A                          1283  ; -----------------------------------------------------------------------------
0000173A                          1284  
0000173A  4EB9 00001744           1285              JSR SKYPLOT
00001740  6000 0034               1286              BRA FLOPLOT
00001744                          1287              ; TODO CLOUD PLOT
00001744                          1288              ; RTS 
00001744                          1289              
00001744                          1290  ; -----------------------------------------------------------------------------
00001744                          1291  SKYPLOT
00001744                          1292  ; DRAWS THE SKY BACKGROUND
00001744                          1293  ; INPUT     : NONE
00001744                          1294  ; OUTPUT    : NONE
00001744                          1295  ; MODIFIES  : NONE
00001744                          1296  ; -----------------------------------------------------------------------------
00001744                          1297              
00001744  48E7 F800               1298              MOVEM.L D0-D4,-(A7)
00001748                          1299              ; SET PEN COLOR
00001748  223C 00FFBF80           1300              MOVE.L  #SKYCOLOR,D1
0000174E  103C 0050               1301              MOVE.B  #80,D0
00001752  4E4F                    1302              TRAP    #15
00001754                          1303              
00001754                          1304              ; SET FILL COLOR
00001754  103C 0051               1305              MOVE.B  #81,D0
00001758  4E4F                    1306              TRAP    #15
0000175A                          1307              
0000175A                          1308              ; SET COORDS AND DRAW
0000175A  103C 0057               1309              MOVE.B  #87,D0
0000175E  4281                    1310              CLR.L   D1
00001760  4282                    1311              CLR.L   D2
00001762  263C 00000280           1312              MOVE.L  #SCRWIDTH,D3
00001768  283C 000001E0           1313              MOVE.L  #SCRHEIGH,D4
0000176E  4E4F                    1314              TRAP    #15
00001770                          1315              
00001770  4CDF 001F               1316              MOVEM.L (A7)+,D0-D4
00001774  4E75                    1317              RTS
00001776                          1318              
00001776                          1319  ; -----------------------------------------------------------------------------
00001776                          1320  FLOPLOT
00001776                          1321  ; DRAWS THE FLOOR BACKGROUND
00001776                          1322  ; INPUT     : NONE
00001776                          1323  ; OUTPUT    : NONE
00001776                          1324  ; MODIFIES  : NONE
00001776                          1325  ; -----------------------------------------------------------------------------
00001776                          1326  
00001776  48E7 F800               1327              MOVEM.L D0-D4,-(A7)
0000177A                          1328              ; SET PEN COLOR 
0000177A  223C 0035DE3B           1329              MOVE.L  #FLOCOLOR,D1
00001780  103C 0050               1330              MOVE.B  #80,D0
00001784  4E4F                    1331              TRAP    #15
00001786                          1332              
00001786                          1333              ; SET FILL COLOR
00001786  103C 0051               1334              MOVE.B  #81,D0
0000178A  4E4F                    1335              TRAP    #15
0000178C                          1336              
0000178C                          1337              ; SET COORDS AND DRAW
0000178C  103C 0057               1338              MOVE.B  #87,D0
00001790  4281                    1339              CLR.L   D1
00001792  243C 000001A4           1340              MOVE.L  #SCRHEIGH-FLOHEIGH,D2
00001798  263C 00000280           1341              MOVE.L  #SCRWIDTH,D3
0000179E  283C 000001E0           1342              MOVE.L  #SCRHEIGH,D4
000017A4  4E4F                    1343              TRAP    #15
000017A6                          1344              
000017A6  4CDF 001F               1345              MOVEM.L (A7)+,D0-D4
000017AA  4E75                    1346              RTS
000017AC                          1347  
000017AC                          1348  -------------------- end include --------------------
000017AC                          1349              INCLUDE "SCORE.X68"
000017AC                          1350  ; =============================================================================
000017AC                          1351  ; SCOREBOARD MANAGEMENT
000017AC                          1352  ; =============================================================================
000017AC                          1353  
000017AC                          1354  ; ------------------------------------------------------------------------------
000017AC                          1355  SCOINIT
000017AC                          1356  ; INITIALIZE SCOREBOARD
000017AC                          1357  ; INPUT    : NONE 
000017AC                          1358  ; OUTPUT   : NONE
000017AC                          1359  ; MODIFIES : NONE
000017AC                          1360  ; ------------------------------------------------------------------------------
000017AC                          1361  
000017AC  48E7 E0C0               1362              MOVEM.L D0-D2/A0-A1,-(A7)
000017B0  4279 000018E8           1363              CLR.W   (SCORE)
000017B6  4279 000018EA           1364              CLR.W   (HIGHSCO)
000017BC                          1365              
000017BC                          1366              ; OPEN FILE
000017BC  43F9 000018F8           1367              LEA     SCOPATH,A1
000017C2  103C 0033               1368              MOVE.B  #51,D0
000017C6  4E4F                    1369              TRAP    #15
000017C8                          1370              
000017C8                          1371              ; READ HIGH SCORE
000017C8  43F9 000018EA           1372              LEA     HIGHSCO,A1
000017CE  7402                    1373              MOVE.L  #2,D2
000017D0  103C 0035               1374              MOVE.B  #53,D0
000017D4  4E4F                    1375              TRAP    #15
000017D6                          1376              
000017D6                          1377              ; CLOSE FILE
000017D6  103C 0038               1378              MOVE.B  #56,D0
000017DA  4E4F                    1379              TRAP    #15
000017DC                          1380              
000017DC  4CDF 0307               1381              MOVEM.L (A7)+,D0-D2/A0-A1
000017E0  4E75                    1382              RTS
000017E2                          1383              
000017E2                          1384  ; -----------------------------------------------------------------------------
000017E2                          1385  SCOINC
000017E2                          1386  ; INCREASES THE SCORE BY 1
000017E2                          1387  ; INPUT     : NONE
000017E2                          1388  ; OUTPUT    : SCORE = SCORE + 1
000017E2                          1389  ; MODIFIES  : NONE (APART FROM OUTPUT)
000017E2                          1390  ; -----------------------------------------------------------------------------
000017E2  48E7 A100               1391              MOVEM.L D0/D2/D7,-(A7)
000017E6                          1392  
000017E6  5279 000018E8           1393              ADDQ.W  #1,(SCORE)
000017EC                          1394              ; STOP ALL SOUNDS
000017EC  103C 004C               1395              MOVE.B  #76,D0
000017F0  7403                    1396              MOVE.L  #3,D2
000017F2  4E4F                    1397              TRAP    #15
000017F4                          1398              
000017F4                          1399              ; PLAY SOUND
000017F4  1E3C 0002               1400              MOVE.B  #SNDSCO,D7
000017F8  4E42                    1401              TRAP    #SNDPLTN
000017FA                          1402              
000017FA  4CDF 0085               1403              MOVEM.L (A7)+,D0/D2/D7
000017FE  4E75                    1404              RTS
00001800                          1405              
00001800                          1406  ; ------------------------------------------------------------------------------
00001800                          1407  SCOPLOT
00001800                          1408  ; PLOT THE SCOREBOARD
00001800                          1409  ; INPUT    : NONE 
00001800                          1410  ; OUTPUT   : NONE
00001800                          1411  ; MODIFIES : NONE
00001800                          1412  ; ------------------------------------------------------------------------------
00001800                          1413  
00001800  48E7 C040               1414              MOVEM.L D0-D1/A1,-(A7)
00001804                          1415  
00001804                          1416              ; SET BACKGROUND COLOR
00001804  103C 0051               1417              MOVE.B  #81,D0
00001808  223C 0035DE3B           1418              MOVE.L  #SCOFCOL,D1
0000180E  4E4F                    1419              TRAP    #15
00001810                          1420              
00001810                          1421              ; SET SCORE LINE POSITION
00001810  103C 000B               1422              MOVE.B  #11,D0
00001814  323C 101D               1423              MOVE.W  #SCOLINE,D1
00001818  4E4F                    1424              TRAP    #15
0000181A                          1425              
0000181A                          1426              ; PLOT THE SCORE
0000181A  43F9 00001852           1427              LEA     .SCOTXT,A1
00001820  4281                    1428              CLR.L   D1
00001822  3239 000018E8           1429              MOVE.W  (SCORE),D1
00001828  103C 0011               1430              MOVE.B  #17,D0
0000182C  4E4F                    1431              TRAP    #15
0000182E                          1432              
0000182E                          1433              ; SET HIGH SCORE LINE POSITION
0000182E  103C 000B               1434              MOVE.B  #11,D0
00001832  323C 101E               1435              MOVE.W  #HSCOLINE,D1
00001836  4E4F                    1436              TRAP    #15
00001838                          1437              
00001838                          1438              ; PLOT THE HIGHSCORE
00001838  43F9 0000185A           1439              LEA     .HISCOTXT,A1
0000183E  4281                    1440              CLR.L   D1
00001840  3239 000018EA           1441              MOVE.W  (HIGHSCO),D1
00001846  103C 0011               1442              MOVE.B  #17,D0
0000184A  4E4F                    1443              TRAP    #15
0000184C                          1444              
0000184C  4CDF 0203               1445              MOVEM.L (A7)+,D0-D1/A1
00001850  4E75                    1446              RTS
00001852                          1447              
00001852= 53 43 4F 52 45 3A ...   1448  .SCOTXT     DC.B    'SCORE: ',0
0000185A= 48 49 47 48 53 43 ...   1449  .HISCOTXT   DC.B    'HIGHSCORE: ',0
00001866                          1450  
00001866                          1451  ; ------------------------------------------------------------------------------
00001866                          1452  SCOSAVE
00001866                          1453  ; SAVES THE HIGH SCORE
00001866                          1454  ; INPUT    : NONE 
00001866                          1455  ; OUTPUT   : NONE
00001866                          1456  ; MODIFIES : NONE
00001866                          1457  ; ------------------------------------------------------------------------------
00001866                          1458  
00001866  48E7 E0C0               1459              MOVEM.L A0-A1/D0-D2,-(A7)
0000186A                          1460              ; IF ACTUAL SCORE > HIGH SCORE
0000186A  3039 000018E8           1461              MOVE.W  (SCORE),D0
00001870  3239 000018EA           1462              MOVE.W  (HIGHSCO),D1
00001876  B240                    1463              CMP.W   D0,D1
00001878  6C00 002C               1464              BGE     .END
0000187C                          1465              
0000187C                          1466              ; OPEN FILE
0000187C  43F9 000018F8           1467              LEA     SCOPATH,A1
00001882  103C 0033               1468              MOVE.B  #51,D0
00001886  4E4F                    1469              TRAP    #15
00001888                          1470              
00001888                          1471              ; SAVE NEW HIGH SCORE
00001888  33F9 000018E8 000018EA  1472              MOVE.W  (SCORE),(HIGHSCO)
00001892  43F9 000018EA           1473              LEA     HIGHSCO,A1
00001898  7402                    1474              MOVE.L  #2,D2
0000189A  103C 0036               1475              MOVE.B  #54,D0
0000189E  4E4F                    1476              TRAP    #15
000018A0                          1477              
000018A0                          1478              ; CLOSE FILE
000018A0  103C 0038               1479              MOVE.B  #56,D0
000018A4  4E4F                    1480              TRAP    #15
000018A6                          1481              
000018A6                          1482              
000018A6  4CDF 0307               1483  .END        MOVEM.L (A7)+,A0-A1/D0-D2
000018AA  4E75                    1484              RTS
000018AC                          1485  
000018AC                          1486  
000018AC                          1487  
000018AC                          1488  
000018AC                          1489  -------------------- end include --------------------
000018AC                          1490              
000018AC                          1491  
000018AC                          1492  START
000018AC                          1493  
000018AC                          1494  ; --- INITIALIZATION ----------------------------------------------------------
000018AC                          1495  
000018AC  007C 0700               1496              ORI.W   #$0700,SR
000018B0  4EB8 12AC               1497              JSR     SYSINIT
000018B4  4EB8 1146               1498              JSR     UTLINIT
000018B8  4EB8 1410               1499              JSR     STAINIT
000018BC                          1500              
000018BC                          1501  .LOOP
000018BC                          1502  
000018BC                          1503  ; --- UPDATE ------------------------------------------------------------------
000018BC                          1504  
000018BC                          1505              ; READ INPUT DEVICES
000018BC                          1506  
000018BC  4E41                    1507              TRAP    #KBDUPDTN
000018BE                          1508  
000018BE  4EB8 1420               1509              JSR     STAUPD
000018C2                          1510              
000018C2                          1511  ; --- SYNC --------------------------------------------------------------------
000018C2                          1512  
000018C2  4A39 000018F4           1513  .WINT       TST.B   (SCRINTCT)
000018C8  67F8                    1514              BEQ     .WINT
000018CA  4239 000018F4           1515              CLR.B   (SCRINTCT)
000018D0                          1516              
000018D0                          1517  ; --- PLOT --------------------------------------------------------------------
000018D0                          1518  
000018D0  4EB8 173A               1519              JSR     BACKPLOT
000018D4  4EB8 1486               1520              JSR     STAPLOT
000018D8                          1521              
000018D8  4E40                    1522              TRAP    #SCRUPDTN
000018DA                          1523              
000018DA  60E0                    1524              BRA     .LOOP
000018DC                          1525              
000018DC  FFFF FFFF               1526              SIMHALT
000018E0                          1527              
000018E0                          1528              INCLUDE "VARS.X68"
000018E0                          1529  ; =============================================================================
000018E0                          1530  ; GAME VARIABLES
000018E0                          1531  ; =============================================================================
000018E0                          1532  
000018E0                          1533  ; --- BIRD RELATED VARIABLES --------------------------------------------------
000018E0                          1534  
000018E0= 00F0                    1535  BIRDPOSY    DC.W    SCRHEIGH/2         ; BIRD POSITION Y
000018E2= 0000                    1536  BIRDVELY    DC.W    0                   ; BIRD SPEED Y
000018E4= BBBB                    1537  BIRDPCOL    DC.W    DKYELLOW            ; BIRD PEN COLOR
000018E6= FFFF                    1538  BIRDFCOL    DC.W    LGYELLOW            ; BIRD FILL COLOR
000018E8                          1539  
000018E8                          1540  ; --- SCOREBOARD RELATED VARIABLES --------------------------------------------
000018E8                          1541  
000018E8                          1542  SCORE       DS.W    1                   ; ACTUAL GAME SCORE
000018EA                          1543  HIGHSCO     DS.W    1                   ; HIGH SCORE
000018EC                          1544  
000018EC                          1545  ;  --- STATE RELATED VARIABLES ------------------------------------------------
000018EC                          1546  
000018EC                          1547  STACUR      DS.W    1                   ; CURRENT STATE
000018EE                          1548  STANEXT     DS.W    1                   ; NEXT STATE
000018F0                          1549  
000018F0                          1550  
000018F0                          1551  
000018F0                          1552  
000018F0                          1553  
000018F0                          1554  
000018F0                          1555  
000018F0                          1556  -------------------- end include --------------------
000018F0                          1557              INCLUDE "LIB/UTLVARS.X68"
000018F0                          1558  ; =============================================================================
000018F0                          1559  ; UTILITY VARIABLES
000018F0                          1560  ; =============================================================================
000018F0                          1561  
000018F0                          1562  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
000018F2                          1563              DS.W    0
000018F2                          1564  -------------------- end include --------------------
000018F2                          1565              INCLUDE "SYSVARS.X68"
000018F2                          1566  ; =============================================================================
000018F2                          1567  ; SYSTEM VARIABLES
000018F2                          1568  ; =============================================================================
000018F2                          1569  
000018F2                          1570  ; --- KEYBOARD RELATED VARIABLES ----------------------------------------------
000018F2                          1571  
000018F2                          1572  KBDVAL      DS.B    1                       ; KEY STATE
000018F3                          1573  KBDEDGE     DS.B    1                       ; KEY EDGE
000018F4                          1574  
000018F4                          1575  ; --- TIMED INTERRUPT RELATED VARIABLES ---------------------------------------
000018F4                          1576  
000018F4                          1577  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER
000018F5                          1578  SCRCYCCT    DS.B    1                       ; SCREEN CYCLE COUNTER
000018F6= 00                      1579  GAMCYCCT    DC.B    0                       ; GAME CYCLE COUNTER
000018F8                          1580              DS.W    0
000018F8                          1581              
000018F8                          1582  ; --- FILE PATHS --------------------------------------------------------------
000018F8                          1583  
000018F8= 44 41 54 41 2F 53 ...   1584  SCOPATH     DC.B     'DATA/SCORES.dat',0
00001908                          1585              DS.W     0
00001908                          1586  
00001908                          1587  
00001908                          1588  
00001908                          1589  
00001908                          1590  -------------------- end include --------------------
00001908                          1591              INCLUDE "LIB/DMMVARS.X68"
00001908                          1592  ; =============================================================================
00001908                          1593  ; DYNAMIC MEMORY MANAGEMENT VARIABLES (SYSTEM VARIABLES)
00001908                          1594  ; =============================================================================
00001908                          1595  
00001940                          1596              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001940                          1597  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
000025C0                          1598              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
000025C0                          1599  -------------------- end include --------------------
000025C0                          1600  
000025C0                          1601              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              10C2
AGLADD:END          10D8
AGLCLEAN            1126
AGLCLEAN:END        1140
AGLCLEAN:LOOP       112A
AGLKILL             10AC
AGLPLOT             1100
AGLPLOT:END         1120
AGLPLOT:LOOP        1108
AGLUPD              10DC
AGLUPD:END          10FA
AGLUPD:LOOP         10E4
BACKPLOT            173A
BIRDFCOL            18E6
BIRDINIT            15C4
BIRDPCOL            18E4
BIRDPLOT            1618
BIRDPOSX            A0
BIRDPOSY            18E0
BIRDRAD             F
BIRDUPD             15C6
BIRDUPD:COLBOT      1604
BIRDUPD:CORDUPD     15F0
BIRDUPD:DONE        1612
BIRDUPD:NOCOL       160C
BIRDUPD:NOJUMP      15EA
BIRDVELY            18E2
DARKRED             BB
DKYELLOW            BBBB
DMMALLOC            1092
DMMALLOC:END        10AA
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1940
DMMFCOM             106C
DMMFFND             107A
DMMFIRST            1022
DMMFLOOP            1060
DMMFRCOM            1034
DMMFREE             10AC
DMMFRFND            1042
DMMFRLOP            1028
DMMFRSTO            105A
DMMINIT             1000
DMMINIT:LOOP        100E
DMMNEXT             1044
DMMNEXTO            107C
DMMSYSID            0
FLOCOLOR            35DE3B
FLOHEIGH            3C
FLOPLOT             1776
GAMCYCCT            18F6
GAMEINIT            14DE
GAMEPLOT            155E
GAMEUPD             14F6
GAMEUPD:NOPAUSE     1518
GOVINIT             15A6
GOVPLOT             15BE
GOVUPD              15AA
GOVUPD:CONT         15BC
HIGHSCO             18EA
HSCOLINE            101E
INSINIT             14D8
INSPLOT             14DC
INSUPD              14DA
ISCINIT             14B8
ISCPLOT             14D6
ISCUPD              14BE
ISCUPD:CONT         14D4
JUMPVELY            FFFFFFF6
KBDEDGE             18F3
KBDINIT             13C2
KBDP                50
KBDSPACE            20
KBDUPD              13D0
KBDUPD:LOOP         1406
KBDUPD:PACK         1402
KBDUPDTN            1
KBDVAL              18F2
LGYELLOW            FFFF
LIGHTRED            FF
MASKNWPP            3F
NEWPIPE             152C
NEWPIPE:GOUPD       1558
PAUSINIT            156C
PAUSINIT:CONT       1584
PAUSPLOT            15A4
PAUSUPD             1588
PAUSUPD:CONT        15A0
PIPEAGTP            1
PIPECOLI            167A
PIPECOLI:COL        16C8
PIPECOLI:END        16F0
PIPECOLI:NOCOL      16E2
PIPECOLI:NOKILL     1690
PIPEFCOL            20284D
PIPEGAPS            78
PIPEINIT            165A
PIPEPCOL            151A30
PIPEPLOT            16F6
PIPEUPD             1672
PIPEVELX            FFFFFFFB
PIPEWIDT            32
SCOFCOL             35DE3B
SCOINC              17E2
SCOINIT             17AC
SCOLINE             101D
SCOPATH             18F8
SCOPLOT             1800
SCOPLOT:HISCOTXT    185A
SCOPLOT:SCOTXT      1852
SCORE               18E8
SCOSAVE             1866
SCOSAVE:END         18A6
SCRCYCCT            18F5
SCRFPS              3C
SCRHEIGH            1E0
SCRINIT             1356
SCRINTCT            18F4
SCRINTN             1
SCRPLOT             139A
SCRTIM              13B4
SCRUPDTN            0
SCRWIDTH            280
SKYCOLOR            FFBF80
SKYPLOT             1744
SNDDIE              0
SNDINIT             12EA
SNDINIT:DONE        1308
SNDINIT:LOOP        12F6
SNDINIT:SNDDIE      130E
SNDINIT:SNDJUMP     131A
SNDINIT:SNDLIST     1334
SNDINIT:SNDSCO      1327
SNDJUMP             1
SNDPLAY             1344
SNDPLTN             2
SNDSCO              2
STACUR              18EC
STAEMPTY            14B6
STAGAME             2
STAGOVER            4
STAINIT             1410
STAINSTR            1
STAINTRO            0
STANEXT             18EE
STANONE             FFFFFFFF
STAPAUSE            3
STAPLOT             1486
STAPLOT:PLTTBL      14A2
START               18AC
START:LOOP          18BC
START:WINT          18C2
STAUPD              1420
STAUPD:DOUPD        1446
STAUPD:INITBL       145E
STAUPD:UPDTBL       1472
SYSINIT             12AC
UTLCHRWD            8
UTLINIT             1146
UTLPRINT            115C
UTLPRINT:ENDLOOP    116E
UTLPRINT:LOOP       1164
UTLRAND             118E
UTLRAND:RANDVEC     11AC
UTLRNDIX            18F0
